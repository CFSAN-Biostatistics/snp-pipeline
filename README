#############################
#Running snp pipeline tests.#
#############################
#Several different cases
scripts/runsnppipeline.py -n 10 -d ~/mnt/biob/svn/Biostats/rand/snppipeline/test/testLambdaVirus/ -f path.txt -r reference/lambda_virus.fa -l snplist.txt -a snpma.fasta -i True
scripts/runsnppipeline.py -n 10 -d ~/mnt/biob/svn/Biostats/rand/snppipeline/test/testAgonaMOM -f path.txt -r lambda_virus.fa -l snplist.txt -a snpma.fasta -i True
#Full test of code
test/test_snppipeline.py -v
test/test_utils.py -v

#####################################################################
#Example: Set up to run the snp pipeline on Lambda Virus and run it.#
#####################################################################

#Prep work
#  The directory and sequence information already exists, so just copy it to
#    a directory to work in.
cd test/testLambdaVirus
#Test new name of sampleDirectoryNames.txt in all following code
#TODO test next line as replacement for following one
ls -1 --color=never $PWD/samples > sampleDirectoryNames.txt
#echo -e "sample1\nsample2\nsample3\nsample4\n" > sampleDirectoryNames.txt

#Set up reference sequence
/home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/prepReference.sh lambda_virus

#Set up sample sequence
#  Note: This could be run in parallel using gnu parallel (workstation) or
#    qsub (PBS on HPC)
cat sampleDirectoryNames.txt | xargs -n 1 /home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/prepSamples.sh lambda_virus
        
#Run snp pipeline (samtools pileup in parallel and combine alignment and pileup to generate snp matrix)
#TODO replace 'path.txt' with better name
ls -d -1 --color=never $PWD/samples/* > path.txt
/home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/runsnppipeline.py -n 10 -d ~/mnt/biob/svn/Biostats/rand/snppipeline/test/testLambdaVirus/ -f path.txt -r reference/lambda_virus.fasta -l snplist.txt -a snpma.fasta -i True
test/test_snppipeline.py -v

#####################################################
#Example: Set up to run the snp pipeline and run it.#
#####################################################

#Prep work
mkdir junk #make a directory to work in
cd junk    #change to it

#Get sequence data
#echo -e "SRR955145\nSRR955146\nERR178930\nERR178931\n" > sampleDirectoryNames.txt
echo -e "ERR178926\nERR178927\nERR178928\nERR178929\nERR178930\n" > sampleDirectoryNames.txt
cat sampleDirectoryNames.txt | xargs -n 1 /home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/prepSequenceData.sh NC_011149

#Set up reference sequence
/home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/prepReference.sh NC_011149

#Set up sample sequence
#  Note: This could be run in parallel using gnu parallel (workstation) or qsub (PBS on HPC)
cat sampleDirectoryNames.txt | xargs -n 1 /home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/prepSamples.sh NC_011149
        
#Run snp pipeline (samtools pileup in parallel and combine alignment and pileup to generate snp matrix)
ls -d -1 --color=never $PWD/samples/* > path.txt
home/hugh.rand/mnt/biob/svn/Biostats/rand/snppipeline/scripts/runsnppipeline.py -n 10 -d ~/mnt/biob/svn/Biostats/rand/snppipeline/test/junk/ -f path.txt -r reference/NC_011149.fasta -l snplist.txt -a snpma.fasta -i True


